mdl2 <- glm(visits ~ date, offset = log(visits+1), family = "poisson", data = hits)
mdl2 <- glm(formula = simplystats ~ date, family = poisson, data = hits, offset = log(visits + 1))
qpois(.95, mdl2$fitted.values[704])
library(MASS)
glm(auto1 ~ wind + 1, data = shuttle)
glm(use ~ wind + 1, data = shuttle)
glm(use ~ ., data = shuttle)
summary(glm(use ~ ., data = shuttle))
summary(glm(factor(use) ~ wind + 1, data = shuttle))
summary(glm(factor(shuttle$use) ~ wind + 1, data = shuttle))
head(shuttle)
library(dplyr)
mutate(shuttle$use, c(0,1))
reorder(shuttle$use, levels = c(0,1))
relevel(shuttle$use, levels = C(0,1))
shuttle$use
shuttle$use <- factor(shuttle$use, levels = c(0,1))
shuttle$use
library(MASS)
library(dplyr)
shuttle$use <- factor(shuttle$use, levels = C("noauto", "auto"), labels(0, 1))
head(shuttle$use)
shuttle$use <- factor(shuttle$use, levels = c("noauto", "auto"), labels(0, 1))
head(shuttle$use)
library(MASS)
head(shuttle$use)
load(shuttle)
load("shuttle")
head(shuttle$use)
shuttle$use <- factor(shuttle$use, levels = c("noauto", "auto"), labels = c(0, 1))
head(shuttle$use)
head(shuttle$wind)
summary(lm(use ~ wind + 1, data = shuttle))
summary(lm(use ~ wind, data = shuttle))
summary(lm(as.numeric(use) ~ wind + 1, data = shuttle))
summary(lm(as.numeric(use) ~ wind + 0, data = shuttle))
a <- summary(lm(as.numeric(use) ~ wind + 0, data = shuttle))
a$coefficients[1,1] / a$coefficients[2,1]
exp(a$coefficients[1,1] / a$coefficients[2,1])
b <- a$coefficients[1,1] / a$coefficients[2,1]
exp(b) / (1 + exp(b))
anova(shuttle$use, shuttle$wind)
anova(as.numeric(shuttle$use), shuttle$wind)
b <- exp(a$coefficients[1,1]) / (1 + exp(a$coefficients[1,1]))
c <- exp(a$coefficients[2,1]) / (1 + exp(a$coefficients[2,1]))
b / c
a <- summary(lm(as.numeric(use) ~ wind + 1, data = shuttle))
A
a
a <- summary(lm(as.numeric(use) ~ wind + 0, data = shuttle))
a
a <- summary(lm(as.factor(use) ~ wind + 0, data = shuttle))
b <- exp(coef(lm(I(log(shuttle$use)) ~ shuttle$wind + 1)))
b <- exp(coef(lm(I(log(as.numeric(shuttle$use))) ~ shuttle$wind + 1)))
b
1.005430 / 1 - 1.005430
1.005430 / (1 - 1.005430)
c <- lm(log(as.numeric(shuttle$use)) ~ shuttle$wind + 1)
c
c <- lm(as.numeric(shuttle$use) ~ shuttle$wind + 1)
c
a <- summary(lm(as.numeric(use) ~ wind + 0, data = shuttle))
a
plot(shuttle$use ~ shuttle$wind)
c <- lm(as.numeric(shuttle$use) ~ shuttle$wind + 1)
c
exp(c$coefficients[2])
shuttle$wind <- factor(shuttle$wind, levels = c("head", "tail"), labels = c(0, 1))
head(shuttle$wind)
a <- summary(lm(as.numeric(use) ~ as.numeric(wind) + 0, data = shuttle))
a
a <- summary(lm(as.numeric(shuttle$use) ~ as.numeric(shuttle$wind) + 0, data = shuttle))
a
exp(a$coefficients[2])
a <- summary(glm(as.numeric(shuttle$use) ~ shuttle$wind + 0, data = shuttle))
a
shuttle$wind <- factor(shuttle$wind, levels = labels = c(0, 1), c("head", "tail"))
a <- summary(glm(as.numeric(shuttle$use) ~ shuttle$wind + 0, data = shuttle))
shuttle$wind <- factor(shuttle$wind, levels = c(0, 1), labels = c("head", "tail"))
a <- summary(glm(as.numeric(shuttle$use) ~ shuttle$wind + 0, data = shuttle))
a
exp(a$coefficients[1,2])
a <- summary(glm(as.numeric(shuttle$use) ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
a
head(shuttle$use)
a <- summary(glm(as.numeric(shuttle$use) ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
a <- summary(glm(shuttle$use ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
a
exp(a$coefficients[2])
a <- summary(glm(shuttle$use ~ shuttle$wind + shuttle$magn 0, data = shuttle, family = "binomial"))
a
a <- summary(glm(shuttle$use ~ shuttle$wind + shuttle$magn 0, data = shuttle, family = "binomial"))
a <- summary(glm(shuttle$use ~ shuttle$wind + shuttle$magn + 0, data = shuttle, family = "binomial"))
a
a$coefficients
a <- summary(glm(shuttle$use ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
exp(a$coefficients[1, 2])
exp(a$coefficients[2])
a <- summary(glm(shuttle$use ~ shuttle$wind + shuttle$magn + 0, data = shuttle, family = "binomial"))
exp(a$coefficients[2])
a$coefficients[2]
a <- summary(glm(shuttle$use ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
b <- summary(glm(I(1 - shuttle$use) ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
a <- summary(glm(as.numeric(shuttle$use) ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
a <- summary(glm(shuttle$use ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
b <- summary(glm(I(1 - as.numeric(shuttle$use)) ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
b <- summary(glm(as.factor(I(1 - as.numeric(shuttle$use))) ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
a$coefficients
b$coefficients
data <- InsectSprays
a <- glm(as.factor(sprays) ~ ., data = data, family = "poisson")
a <- glm(as.factor(spray) ~ ., data = data, family = "poisson")
a <- glm(spray ~ . + 1, data = data, family = "poisson")
data$spray
a <- glm(count ~ spray + 1, data = data, family = "poisson")
summary(a)
a <- glm(count ~ spray + 0, data = data, family = "poisson")
summary(a)
data <- data[data$spray == c("A", "B")]
data <- data[data$spray == c("A", "B"), ]
head(data)
a <- glm(count ~ spray + 0, data = data, family = "poisson")
summary(a)
exp(a$coefficients[2])
exp(a$coefficients[a])
exp(a$coefficients[1])
exp(a$coefficients[1]) / exp(a$coefficients[2])
a <- glm(count ~ spray, data = data, family = "poisson")
summary(a)
exp(a$coefficients[1]) / exp(a$coefficients[2])
exp(a$coefficients[2])
0.1085 / 0.1037
levels(spray)
levels(data$spray)
a <- glm(count ~ spray, data = data, family = "poisson")
a$
0.1085 / 0.1037
a$coefficients
summary(a)
a <- summary(glm(shuttle$use ~ shuttle$wind + 0, data = shuttle, family = "binomial"))
a
a$coefficients
a$coefficients[2]
a$coefficients[1, 2]
exp(a$coefficients[1, 2])
a$coefficients[1, 1] - a$coefficients[2, 1]
a$coefficients[1, 1] / a$coefficients[2, 1]
a$coefficients[1, 2] / a$coefficients[2, 2]
exp(a$coefficients[1, 1])
exp(a$coefficients[1, 2])
a <- glm(shuttle$use ~ shuttle$wind + 0, data = shuttle, family = "binomial")
a
exp(a$coefficients[1])
exp(a$coefficients[1]) / exp(a$coefficients[2])
a <- glm(shuttle$use ~ shuttle$wind + shuttle$magn + 0, data = shuttle, family = "binomial")
a
exp(a$coefficients[1]) / exp(a$coefficients[2])
0.635/0.955
exp(0.635)/exp(0.955)
exp(0.3635)/exp(0.3955)
head(data$spray)
unique(data$spray)
a <- glm(count ~ spray, data = data, family = "poisson")
a$coefficients
summary(a)
a$coefficients
a <- glm(count ~ spray + 1, data = data, family = "poisson")
a$coefficients
summary(a)
a <- glm(count ~ spray + 0, data = data, family = "poisson")
summary(a)
a$coefficients
exp(a$coefficients[1]) / exp(a$coefficients[2])
plot(count ~ spray, data = data)
exp(a$coefficients[1,2]) / exp(a$coefficients[2,2])
coef(a)
exp(coef(a))
exp(coef(a))[1] / exp(coef(a))[2]
mean(InsectSprays$count[InsectSprays$spray == "A"])
log(10)
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
x <- 0:5
x <- 0:5
y <- c(0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
lm(y ~ x)
lm(y ~ x + 0)
lm(y ~ x)
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
z <- (x > 0) * x
z
fit <- lm(y ~ x + z)
fit
sum(coef(fit)[2:3])
mtcars?
?mtcars
library(ggplot2)
ggplot(data = mtcars, mpg, am, eas(y = mpg, x = am, color = wt, size = cyl))
ggplot(data = mtcars, mpg, am, aes(y = mpg, x = am, color = wt, size = cyl))
ggplot(data = mtcars, mpg, am) + geom_point(aes(y = mpg, x = am, color = wt, size = cyl))
ggplot(data = mtcars, mpg, am, aes(y = mpg, x = am)) + geom_point(color = wt, size = cyl))
ggplot(data = mtcars, mpg, am, aes(y = mpg, x = am)) + geom_point(color = wt, size = cyl)
ggplot(data = mtcars, mpg, am, aes(y = mpg, x = am)) + geom_point(aes(y,x), color = wt, size = cyl)
ggplot(mpg, am, data = mtcars, aes(y = mpg, x = am)) + geom_point(aes(y = mpg, x = am), color = wt, size = cyl)
ggplot(mpg, am, data = mtcars, aes(y = mpg, x = am)) + geom_point(aes(y = mpg, x = am))
qplot(mpg, am, data = mtcars)
head(mtcars$am)
mtcars$am <- as.factor(mtcars, labels = c("automatic", "manual"))
mtcars$am <- as.factor(mtcars$am, labels = c("automatic", "manual"))
mtcars$am <- factor(mtcars$am, labels = c("automatic", "manual"))
qplot(mpg, am, data = mtcars)
qplot(am, mpg, data = mtcars)
qplot(am, mpg, data = mtcars, size = cyl, color = wt)
head(mtcars)
qplot(am, mpg, data = mtcars, size = cyl, color = wt, shape = gear)
qplot(am, mpg, data = mtcars, size = cyl, color = wt, shape = vs)
qplot(am, mpg, data = mtcars, size = cyl, color = wt, shape = as.factor(vs))
fit_all <- lm(mpg ~ wt + cyl + am + gear + disp + drat + carb + 1, data = mtcars)
summary(fit_all)
qplot(am, mpg, data = mtcars, size = cyl, color = wt, shape = am)
qplot(am, mpg, data = mtcars, size = cyl, color = wt)
fit_all <- lm(mpg ~ wt + cyl + am + gear + hp + disp + drat + carb + 1, data = mtcars)
summary(fit_all)
coef(fit_all)
summary(fit_all)$Coefficients
summary(fit_all)$coef
unique(mtcars$gear)
qplot(am, mpg, data = mtcars, size = cyl, color = wt, shape = as.factor(gear))
qplot(am, mpg, data = mtcars, size = cyl, color = wt, shape = as.factor(gear), main = "Plot_1: Differences between manual and automatic transmission", xlab = "Transmission type", ylab = "Miles per gallon")
qplot(am, mpg, data = mtcars, size = as.numeric(cyl), color = wt, shape = as.factor(gear), main = "Plot_1: Differences between manual and automatic transmission", xlab = "Transmission type", ylab = "Miles per gallon")
qplot(am, mpg, data = mtcars, size = as.factor(cyl), color = wt, shape = as.factor(gear), main = "Plot_1: Differences between manual and automatic transmission", xlab = "Transmission type", ylab = "Miles per gallon")
fit_1 <- lm(mpg ~ am + 1, data = mtcars)
summary(fit_1)$coef
fit_1 <- lm(mpg ~ am + 0, data = mtcars)
summary(fit_1)$coef
fit_all <- lm(mpg ~ wt + cyl + am + gear + hp + disp + drat + carb + 0, data = mtcars)
summary(fit_all)$coef
fit_all <- lm(mpg ~ am + wt + cyl + vs + gear + hp + disp + drat + carb + 0, data = mtcars)
summary(fit_all)$coef
fit_1 <- lm(mpg ~ am + 0, data = mtcars)
summary(fit_1)$coef
fit_1 <- lm(mpg ~ am, data = mtcars)
summary(fit_1)$coef
fit_all <- lm(mpg ~ am + wt + cyl + vs + gear + hp + disp + drat + carb, data = mtcars)
summary(fit_all)$coef
coef(fit_1)
rel_diff <- coef(fit_1)[1] / coef(fit_1)[2]
rel_diff
rel_diff <- coef(fit_1)[2] / coef(fit_1)[1]
rel_diff
rel_diff <- as.numeric(coef(fit_1)[2] / coef(fit_1)[1])
rel_diff
rel_diff <- round(as.numeric(coef(fit_1)[2] / coef(fit_1)[1]) * 100), 0)
rel_diff <- round(as.numeric(coef(fit_1)[2] / coef(fit_1)[1]) * 100, 0)
rel_diff
fit_1 <- glm(mpg ~ am, data = mtcars, family = "poisson")
fit_1 <- glm(mpg ~ am, data = mtcars)
summary(fit_1)$coef
qplot(mpg, qsec, ddata = mtcars, shape = am, color = wt, size = as.factor(cyl))
qplot(mpg, qsec, data = mtcars, shape = am, color = wt, size = as.factor(cyl))
qplot(mpg, qsec, data = mtcars, shape = am, color = wt, size = as.factor(cyl)) + geom_abline(lm(mpg ~ qsec, data = mtcars), aes(x = mpg, y = qsec, color = am))
qplot(mpg, qsec, data = mtcars, shape = am, color = wt, size = as.factor(cyl)) + geom_abline(lm(mpg ~ qsec, data = mtcars), aes(color = am))
qplot(mpg, qsec, data = mtcars, shape = am, color = wt, size = as.factor(cyl)) + geom_smooth(method = "lm")
ggplot(mpg, qsec, data = mtcars) + geom_smooth(method = "lm") + geom_point(shape = am, color = wt, size = as.factor(cyl))
ggplot(mpg, qsec, data = mtcars) + geom_smooth(method = "lm") + geom_point(aes(shape = am, color = wt, size = as.factor(cyl)))
ggplot(aes(mpg, qsec), data = mtcars) + geom_smooth(method = "lm") + geom_point(shape = am, color = wt, size = as.factor(cyl))
ggplot(aes(mpg, qsec), data = mtcars) + geom_smooth(method = "lm") + geom_point(data = mtcars, shape = am, color = wt, size = as.factor(cyl))
ggplot(aes(mpg, qsec), data = mtcars) + geom_smooth(method = "lm") + geom_point(shape = mtcars$am, color = wt, size = as.factor(cyl))
ggplot(aes(mpg, qsec), data = mtcars) + geom_smooth(method = "lm") + geom_point(aes(shape = am, color = wt, size = as.factor(cyl)))
ggplot(aes(mpg, qsec), data = mtcars) + geom_smooth(method = "lm", aes(linetype = am)) + geom_point(aes(shape = am, color = wt, size = as.factor(cyl)))
ggplot(aes(mpg, qsec), data = mtcars) + geom_smooth(method = "lm", se = FALSE, aes(linetype = am)) + geom_point(aes(shape = am, color = wt, size = as.factor(cyl)))
ggplot(aes(am, cyl), data = mtcars) + geom_point(aes(size = gear, color = disp, shape = carb))
ggplot(aes(am, cyl), data = mtcars) + geom_point(aes(size = gear, color = disp, shape = as.factor(carb)))
ggplot(aes(am, drat), data = mtcars) + geom_point(aes(size = gear, color = disp, shape = as.factor(carb)))
ggplot(aes(am, drat), data = mtcars) + geom_point(aes(size = as.factor(gear), color = disp, shape = as.factor(carb)))
qplot(vs, am, data = mtcars)
table(mtcars$am ~ mtcars$vs)
table(mtcars$am, mtcars$vs)
with(mtcars, table(am, carb))
princomp(mtcars)
princomp(mtcars[, c(1,2,3,4,5,6,8,9,10,11)])
princomp(mtcars[, c(1,2,3)])
princomp(mtcars[, c(1,2,3,4)])
princomp(mtcars[, c(1,2,3,4,5)])
princomp(mtcars[, c(1,2,3,4,5,6)])
princomp(mtcars[, c(1,2,3,4,5,6,7)])
princomp(mtcars[, c(1,2,3,4,5,6,7,8)])
princomp(mtcars[, c(1,2,3,4,5,6,7,8,9)])
unique(mtcars$am)
mtcars$am <- factor(mtcars$am, labels = c(0, 1))
princomp(mtcars[, c(1,2,3,4,5,6,7,8,9,10,11)])
princomp(mtcars[, c(1,2,3,4,5,6,7,8,9)])
princomp(mtcars[, c(1,2,3,4,5,6,7,8,10,11)])
summary(prcomp(mtcars[, c(1,2,3,4,5,6,7,8,10,11)], center = TRUE, scale = TRUE))
is(mtcars$vs)
mtcars$am <- as.numeric(factor(mtcars$am, labels = c(0, 1)))
summary(prcomp(mtcars[, c(1,2,3,4,5,6,7,8,9,10,11)], center = TRUE, scale = TRUE))
summary(prcomp(mtcars[, c(2,3,5,6,8,9,10,11)], center = TRUE, scale = TRUE))
library(devtools)
install_github("vqv/ggbiplot")
library(ggbiplot)
summary(prcomp(mtcars[, c(1,2,3,5,6,8,9,10,11)], center = TRUE, scale = TRUE))
biplot(prcomp(mtcars[, c(1,2,3,5,6,8,9,10,11)], center = TRUE, scale = TRUE)))
biplot(prcomp(mtcars[, c(1,2,3,5,6,8,9,10,11)], center = TRUE, scale = TRUE))
ggbiplot(prcomp(mtcars[, c(1,2,3,5,6,8,9,10,11)], center = TRUE, scale = TRUE))
qplot(mpg, vs, ddata = mtcars) + points(aes(shape = am))
qplot(mpg, vs, data = mtcars) + points(aes(shape = am))
qplot(aes(mpg, vs), data = mtcars) + points(aes(shape = am))
qplot(aes(mpg, vs), data = mtcars) + geom_points(aes(shape = am))
ggplot(aes(mpg, vs), data = mtcars) + geom_point(aes(shape = am))
ggplot(aes(mpg, vs), data = mtcars) + geom_point(aes(shape = as.factor(am)))
ggplot(aes(vs, mpg), data = mtcars) + geom_point(aes(shape = as.factor(am)))
qplot(am, mpg, data = mtcars, size = as.factor(cyl), color = wt, shape = as.factor(gear), main = "Plot_1: Differences between manual and automatic transmission", xlab = "Transmission type", ylab = "Miles per gallon")
sort(mtcars$mpg, decreasing = TRUE)[1]
summary(fit_1)$coef
summary(fit_1)
fit_1
summary(fit_1)
fit_1 <- lm(mpg ~ am, data = mtcars)
summary(fit_1)
summary(fit_1)[7]
summary(fit_1)[6]
summary(fit_1)[5]
summary(fit_1)[4]
summary(fit_1)[8]
summary(fit_all)$coef
summary(fit_all)
summary(fit_2)
fit_2 <- lm(mpg ~ am + wt + cyl, data = mtcars)
summary(fit_2)
fit_2 <- lm(mpg ~ am + wt + cyl + hp, data = mtcars)
summary(fit_2)
fit_2 <- lm(mpg ~ cyl + hp + wt + am, data = mtcars)
summary(fit_2)
plot(mpg ~ ., data = mtcars)
pairs(mtcars)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
anova(fit_1, fit_2, fit_all)
pairs(mtcars[, c(1,2,4,6,9)])
anova(fit_1, fit_2, fit_all)
plot(fit_2)
grid(2,2)
plot(fit_2)
grid(2,2)
grid(2,2, plot(fit_2))
plot(fit_2, panel = grid(2,2))
plot(fit_2, panel)
par(mfrow = c(2,2))
plot(fit_2)
par(mfrow = c(2,2))
plot(fit_2)[1]
plot(fit_2)[2]
plot(fit_2)[3]
plot(fit_2)[4]
plot(fit_2)[1]
par(mfrow = c(2,2))
plot(fit_2)[1]
plot(fit_2)[2]
plot(fit_2)[3]
plot(fit_2)[4]
plot(fit_2)[[1]]
plot.lm(fit_2)
par(mfrow = c(2, 2), oma = c(0, 0, 2, 0))
plot(fit_2)
r_sq <- round(as.numeric(summary(fit_1))[8]*100, 0)
r_sq <- round(summary(fit_1)[8]*100, 0)
fit_1 <- lm(mpg ~ am, data = mtcars)
summary(fit_1)$coef
summary(mtcars)
head(mtcars)
summary(fit_1)[8]
fit_1 <- lm(mpg ~ am, data = mtcars)
summary(fit_1)$coef
summary(fit_1)[8]
r_sq <- round(a*100, 0)
a <- summary(fit_1)[8]
r_sq <- round(a*100, 0)
a <- summary(fit_1)[8]
a
a <- summary(fit_1)$r.squared
r_sq <- round(a*100, 0)
rel_diff <- round(as.numeric(coef(fit_1)[2] / coef(fit_1)[1]) * 100, 0)
?par
par(mfrow = c(2, 2), oma = c(0, 0, 0, 0), lheight = 800)
plot(fit_2)
mtcars$vs <- as.factor(mtcars$vs)
interval <- confint(coef(fit_1), 0.95)
interval <- confint(coef(fit_1)[1], 0.95)
interval <- confint(coef(fit_1), "amManual")
interval <- confint(fit_1, "amManual")
confint(fit_1, "amManual")
fit_1 <- lm(mpg ~ am, data = mtcars)
summary(fit_1)$coef
confint(fit_1, "am")
summary(fit_1)$coef
abs_dif <- summary(fit_1)$coef[2,1]
abs_diff <- summary(fit_1)$coef[2,1]
conf_int <- confint(fit_1, "am")
conf_int_1 <- confint(fit_1, "am")[1]
conf_int_2 <- confint(fit_1, "am")[2]
confint(fit_1, "am")
conf_int_1$2.5
conf_int_1
conf_int_1 <- round(confint(fit_1, "am")[1], 2)
conf_int_1
fit_1 <- lm(mpg ~ am, data = mtcars)
summary(fit_1)$coef
r_sq <- round(summary(fit_1)$r.squared*100, 0)
abs_diff <- summary(fit_1)$coef[2,1]
rel_diff <- round(as.numeric(coef(fit_1)[2] / coef(fit_1)[1]) * 100, 0)
conf_int_1 <- round(confint(fit_1, "am")[1], 2)
conf_int_2 <- round(confint(fit_1, "am")[2], 2)
confint(fit_1, "am")
fit_2 <- lm(mpg ~ cyl + hp + wt + am, data = mtcars)
summary(fit_2)$coef
summary(fit_2)
summary(fit_2)$coef[5,4]
confint(fit_1, "ammanual")
confint(fit_1[2])
confint(fit_1)
confint(fit_1, "am|ammanual")
confint(fit_1, "am[manual]")
confint(fit_1)
setwd("D:/R/GitHub/Kazalniki_kakovosti")
library("stringr")
library("googlesheets")
library("dplyr")
preberi_tabelo <- gs_url("https://docs.google.com/spreadsheets/d/1f7wn_vTYlDa2ZMAu8WEObO6BGInJQocg-dhMeVSmKrw/edit#gid=1087390009")
data_1 <- gs_read(gs_title("Kazalniki kakovosti rodov Zveze tabornikov Slovenije (Responses)"), 1)
data <- names(data_1)
data
data <- str_sub(data, length(data) - 3, length(data))
data
str_replace(data, "*\\[[[:digit:]]\\]", "\\[[[:digit:]]\\]")
str_extract(data, "\\[[[:digit:]]\\]")
data <- names(data_1)
str_extract(data, "\\[[[:digit:]]\\]")
data <- names(data_1)
data <- str_extract(data, "\\[[[:digit:]]\\]")
data <- str_extract(data, "[[:digit:]]")
data <- data[!is.na(data)]
data
data <- as.numeric(data[!is.na(data)])
hist(data)
library(ggplot2)
library(stringr)
library(googlesheets)
library(dplyr)
library(ggplot2)
ggplot(data) + geom_bar()
data <- data.frame(as.numeric(data[!is.na(data)]))
data <- names(data_1)
data <- str_extract(data, "\\[[[:digit:]]\\]")
data <- str_extract(data, "[[:digit:]]")
data <- data.frame(as.numeric(data[!is.na(data)]))
ggplot(data) + geom_bar()
data <- as.numeric(data[!is.na(data)])
hist(data)
data$utezi <- as.numeric(data[!is.na(data)])
data <- names(data_1)
data <- str_extract(data, "\\[[[:digit:]]\\]")
data <- str_extract(data, "[[:digit:]]")
data <- as.numeric(data[!is.na(data)])
ggplot(data, aes(x = data))
qplot(as.factor(data), geom="histogram")
qplot(as.factor(data), geom="histogram", stat = "count")
qplot(data)
qplot(as.factors(data))
qplot(as.factor(data))
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text",
position = position_stack(vjust = 0.5,
reverse = TRUE))
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count.., color = "white"),
geom = "text",
position = position_stack(vjust = 0.5, reverse = TRUE),)
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count.., color = "red"),
geom = "text",
position = position_stack(vjust = 0.5, reverse = TRUE),)
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white",
position = position_stack(vjust = 0.5, reverse = TRUE),)
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 15,
position = position_stack(vjust = 0.5, reverse = TRUE),)
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 10,
position = position_stack(vjust = 0.5, reverse = TRUE),)
pdf("histogram_utezi.pdf")
a <- qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 10,
position = position_stack(vjust = 0.5, reverse = TRUE),)
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 10,
position = position_stack(vjust = 0.5, reverse = TRUE),)
ggsave("histogram_utezi.pdf")
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 10,
position = position_stack(vjust = 0.5, reverse = TRUE),)
ggsave("histogram_utezi.pdf", device = "pdf")
ggplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 10,
position = position_stack(vjust = 0.5, reverse = TRUE),)
qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 10,
position = position_stack(vjust = 0.5, reverse = TRUE),)
a <- qplot(as.factor(data)) + stat_count(aes(y = ..count.., label = ..count..),
geom = "text", color = "white", size = 10,
position = position_stack(vjust = 0.5, reverse = TRUE),)
ggsave("histogram_utezi.pdf", a, device = "pdf")
